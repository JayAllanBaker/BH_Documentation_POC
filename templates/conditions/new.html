{% extends "base.html" %}

{% block content %}
<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card">
                <div class="card-header">
                    <h2>New Condition</h2>
                    <p class="text-muted mb-0">Patient: {{ patient.family_name }}, {{ patient.given_name }}</p>
                </div>
                <div class="card-body">
                    <form method="POST">
                        <div class="mb-3">
                            <label for="clinical_status" class="form-label required-field">Clinical Status</label>
                            <select class="form-select" id="clinical_status" name="clinical_status" required>
                                <option value="">Select status</option>
                                <option value="active">Active</option>
                                <option value="recurrence">Recurrence</option>
                                <option value="relapse">Relapse</option>
                                <option value="inactive">Inactive</option>
                                <option value="remission">Remission</option>
                                <option value="resolved">Resolved</option>
                            </select>
                        </div>

                        <div class="mb-3">
                            <label for="verification_status" class="form-label">Verification Status</label>
                            <select class="form-select" id="verification_status" name="verification_status">
                                <option value="">Select status</option>
                                <option value="unconfirmed">Unconfirmed</option>
                                <option value="provisional">Provisional</option>
                                <option value="differential">Differential</option>
                                <option value="confirmed">Confirmed</option>
                                <option value="refuted">Refuted</option>
                                <option value="entered-in-error">Entered in Error</option>
                            </select>
                        </div>

                        <div class="mb-3">
                            <label for="category" class="form-label">Category</label>
                            <select class="form-select" id="category" name="category">
                                <option value="">Select category</option>
                                <option value="problem-list-item">Problem List Item</option>
                                <option value="encounter-diagnosis">Encounter Diagnosis</option>
                            </select>
                        </div>

                        <div class="mb-3">
                            <label for="severity" class="form-label">Severity</label>
                            <select class="form-select" id="severity" name="severity">
                                <option value="">Select severity</option>
                                <option value="mild">Mild</option>
                                <option value="moderate">Moderate</option>
                                <option value="severe">Severe</option>
                            </select>
                        </div>

                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="code" class="form-label">Condition Code</label>
                                <input type="text" class="form-control" id="code" name="code" placeholder="e.g., J45.909">
                            </div>
                            <div class="col-md-6">
                                <label for="code_system" class="form-label">Code System</label>
                                <input type="text" class="form-control" id="code_system" name="code_system" placeholder="e.g., http://snomed.info/sct">
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="body_site" class="form-label">Body Site</label>
                            <input type="text" class="form-control" id="body_site" name="body_site">
                        </div>

                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="onset_date" class="form-label">Onset Date</label>
                                <input type="date" class="form-control" id="onset_date" name="onset_date">
                            </div>
                            <div class="col-md-6">
                                <label for="onset_string" class="form-label">Onset Description</label>
                                <input type="text" class="form-control" id="onset_string" name="onset_string">
                            </div>
                        </div>

                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="abatement_date" class="form-label">Abatement Date</label>
                                <input type="date" class="form-control" id="abatement_date" name="abatement_date">
                            </div>
                            <div class="col-md-6">
                                <label for="abatement_string" class="form-label">Abatement Description</label>
                                <input type="text" class="form-control" id="abatement_string" name="abatement_string">
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="notes" class="form-label">Notes</label>
                            <textarea class="form-control" id="notes" name="notes" rows="3"></textarea>
                        </div>

                        <div class="d-grid gap-2">
                            <button type="submit" class="btn btn-primary">Create Condition</button>
                            <a href="{{ url_for('conditions.list_conditions', patient_id=patient.id) }}" class="btn btn-secondary">Cancel</a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.required-field::after {
    content: " *";
    color: #dc3545;
    font-weight: bold;
    display: inline-block;
}
</style>
{% endblock %}
